---
classes:
  -  foodity_common
  -  foodity_puppet
  -  foodity_timkayaws

###########################################################################################################
###################################### AMAZON CONFIGURATION ###############################################
###########################################################################################################

aws_region: 'eu-west-1'

aws_access_key_id: ENC[PKCS7,MIIBiQYJKoZIhvcNAQcDoIIBejCCAXYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEANrLKaNiJ1dt8YeH2tatvryWqfljQwEA8EXxMyBTvFsHbblJ5Utu6kvm1CjBranMNyldttb/YeDXAK2GPo0pvNIK+1nC1bQYI83zCv5mft0ey9cDtvQZNI8s2MVHUaitRjOCT+rtXXZuCnMxQjBNKg9cgK3mG9jIxNfDyam6jtKUKklbYKkKeIU5fb3RZr/nJEAeeNVaoEf5vjB6sN3HfUG5OSOq+HJHxG/KbOFB4StRChy51JOLUWUnFGxbSYJOObqyQc0/4n9FqU4WKeHcCzld0B3Ucrc1b4DMRXT+OlcHFBTCtIStQRYDUyDavaRHtTVqQqixXZcA0VLwmIwSAojBMBgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBBiYhvGYXS8KtiQTeKHAElhgCAya3HVYzfDrNXITwnTM90GlI5vZo2ydzYw7uM6Z2bTdw==]

aws_secret_access_key: ENC[PKCS7,MIIBmQYJKoZIhvcNAQcDoIIBijCCAYYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAi+cNWUo55HuEzQDRvLl6UX8A7Ckokz5FrhqhZiop2vpEJju2leGHkPZ28OcCcf6MRn9ySukEVUSFCuojYOl7iLfq+PqTkLF/46lcVrKvSAO61+vOXuh9mnGF5S8BucMHWTcB26R1KANOVOPQ2XF5qI0HbWNAqeZCgcWn+xRnP0cJ96NJda33ohnLWmeGWRU9DK679AGVNXJ1qjD6z9XUkeDC6EBkkwn0BY/rk090sdxGqluK2neHWH+LpNDX3/O4lRAGyXtkfo8SWBvm6Ozljvd6EQg0RBRl/O0VdekIVWAOKF67Q7UwpAMM1PUARkb6CyxlCcBQpJADrkx55uHOBDBcBgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBAZC7NLSNVqPLkQme8D6kddgDBzyzqtQDAFKWd4KgWA/VKvWLNukjx13mOzVbXrEJynzZOHxHt2XHK5RjYUGXFzitY=]

aws_files:
  '/home/ubuntu/.awssecret':
    owner: 'ubuntu'
    group: 'ubuntu'
    mode: '400'
    ensure: file
    content: ENC[PKCS7,MIIBqQYJKoZIhvcNAQcDoIIBmjCCAZYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEACSoffURvJTQvlAXav2MCtp95R7SwiEkqzW4TE0O5B3Ck0Blw1RLCB8KIC7wn2B+ax1w/nhphV91fsLxHiwv2D/lB1M4FaKUqGMHvymh5JCloj3tHcJTbPIApWkOh3vsiQJS1wgbR4mz6k2ElaTymPzbwkou5hLWqdJfAAu+LyM6+SRG7JAg5hYKMolJIC4EkC4M+VSdWSFgeX3BfQ4UN6mlSjNNLlvsKvbAxgcDyT32V5rtK+IGU7gAUWUAzKWCZqFVAbf1j5SEBB9ppwZ7OAmFa49Odv8pWcRllxI7P4LASz+q2d9o5pucYTOdumkgq6wS+gk6HblBuXLorFvNjCzBsBgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBCEk0u5pWQYa7BSVB77JJHNgEBoJ985aFiFyVSnWU+u7TWH4yk9nB4NNX7R9sV0uZerV5z7PEN4j/WGqUxuiD6ufJCpRSkkLAXVa4soKMdc7LlT]
    require:
      - User[ubuntu]
      - File[/home/ubuntu]

  '/home/ubuntu/.awsrc':
    owner: 'ubuntu'
    group: 'ubuntu'
    mode: '400'
    ensure: file
    content: |
        --insecure-aws
        --region=eu-west-1
    require:
      - User[ubuntu]
      - File[/home/ubuntu]

  '/usr/bin/':
    owner: 'root'
    ensure: 'directory'
    group: 'root'
    mode:  '755'
    recurse: remote
    source: 'puppet:///modules/foodity_timkayaws/aws'


###################################################################################################################
#############################################INSTALLED PACKAGES####################################################
###################################################################################################################

software:
  vim:
    ensure: 'latest'
  pv:
    ensure: 'latest'
  git:
   ensure: 'latest'
  python-pip: 
    ensure: 'latest'
  build-essential: 
    ensure: 'latest'
  checkinstall: 
    ensure: 'latest'
  lynx:
    ensure: 'latest'
  nmap:
    ensure: 'latest'
  dselect:
    ensure: 'latest'
  tree:
    ensure: 'latest'
  expect:
    ensure: 'latest'
  ri1.8:
    ensure: 'latest'
  libxslt1-dev:
    ensure: 'latest'
  libxml2-dev:
    ensure: 'latest'
  rubygems:
    ensure: 'present'
    before: [ 'Package[deep_merge]', 'Package[hiera-eyaml]', 'Package[highline]']
  deep_merge:
    ensure: '1.0.1'
    provider: 'gem'
  hiera-eyaml:
    ensure: '2.0.3'
    provider: 'gem'
  highline:
    ensure: '1.6.21'
    provider: 'gem'
  nokogiri: 
    ensure: '1.5.11'
    provider: 'gem'
    require: [ 'Package[libxslt1-dev]', 'Package[libxml2-dev]' ]
  aws-sdk:
    ensure: present
    provider: gem
    require: [ 'Package[build-essential]', 'Package[nokogiri]' ]

######################################## RUBY CONFIGURATION ###########################################

rvm_system_rubys:
  'ruby-1.9.3-p547':
    ensure: 'present'
    default_use: true

rvm_gemsets:
  'ruby-1.9.3-p547@puppet':
    ensure: present
    require: 'Rvm_system_ruby[ruby-1.9.3-p547]'

rvm_gems:
  'ruby-1.9.3-p547@puppet/deep_merge':
    ensure: '1.0.1'
    require: 'Rvm_system_ruby[ruby-1.9.3-p547]'
  'ruby-1.9.3-p547@puppet/hiera-eyaml':
    ensure: '2.0.3'
    require: 'Rvm_system_ruby[ruby-1.9.3-p547]'
  'ruby-1.9.3-p547@puppet/highline':
    ensure: '1.6.21'
    require: 'Rvm_system_ruby[ruby-1.9.3-p547]'
  'ruby-1.9.3-p547@puppet/nokogiri':
    ensure: '1.6.3.1'
    require: 'Rvm_system_ruby[ruby-1.9.3-p547]'
  'ruby-1.9.3-p547@puppet/aws-sdk':
    ensure: '1.52.0'
    require: 'Rvm_system_ruby[ruby-1.9.3-p547]'
